"""
Утилиты для обработки текста
"""

import re
from typing import List


def normalize_whitespace(text: str) -> str:
    """
    Заменяет последовательности из более чем одного пробельного символа на один пробел.
    Сохраняет все переносы строк (одиночные и множественные) для RAG.
    
    Args:
        text: Текст для нормализации
        
    Returns:
        Текст с нормализованными пробелами, но сохраненными переносами строк
    """
    # Заменяем последовательности пробелов и табуляций на один пробел
    # Но сохраняем переносы строк (они важны для структуры документа)
    # Разбиваем на строки, нормализуем каждую строку отдельно, затем собираем обратно
    lines = text.split('\n')
    normalized_lines = []
    for line in lines:
        # Нормализуем пробелы и табуляции внутри строки
        normalized_line = re.sub(r'[ \t]+', ' ', line)
        normalized_lines.append(normalized_line)
    # Собираем обратно, сохраняя все переносы строк
    return '\n'.join(normalized_lines)

